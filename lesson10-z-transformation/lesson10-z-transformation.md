# 前言
Z变换（ZT）是对离散序列进行的一种数学变换，将时域信号转换到Z域，将以n为变量的函数转换为以复数变量z为变量的函数，常用于求线性时不变差分方程的解，它在离散系统中的地位如同拉普拉斯变换在连续系统中的地位，Z变换已成为分析线性时不变离散系统问题的重要工具，并且在数字信号处理 、计算机控制系统等领域有着广泛的应用。本章讲解了Z变换和反Z变换的计算方法和性质，下面两个章节FIR、IIR滤波器中讲解了Z变换的具体应用。
# z变换
## 定义及收敛区域概念
### 定义：
z变换是一种对离散序列进行数学变换的工具，在数字信号处理领域有着重要应用。给定离散序列$x[n]$，其z变换$X(z)$定义为：
$$X(z)=\sum_{n = -\infty}^{\infty}x[n]z^{-n}$$
这里的$z$是一个复数变量，$z = r e^{j\omega}$（其中$r$是模，$\omega$是辐角）。

同时，还有反z变换的定义，它可以由$X(z)$还原出原离散序列$x[n]$，公式为：
$$x[n]=\frac{1}{2\pi j}\oint_C X(z)z^{n - 1}dz$$
其中$C$为包含原点的逆时针封闭路径，并且这个路径要落在收敛区域内。
### 收敛区域：
收敛区域（ROC）是使z变换收敛的复数平面上的$z$点集合，其定义为：
$$ROC = \{z:\sum_{n = -\infty}^{\infty}|x[n]z^{-n}|<\infty\}$$
简单来说，就是对于不同的离散序列$x[n]$，只有当$z$取值在特定的区域内时，上述$X(z)$的无穷级数求和才会收敛到一个有限值，这个特定区域就是收敛区域。

例如，对于一些简单的离散序列，其收敛区域可能是整个复数平面除了某些特殊点之外，而对于另一些序列，收敛区域可能是一个环形区域或者是以原点为中心的圆盘区域等。通过分析不同信号的z变换收敛区域，可以更好地理解z变换的性质以及后续在处理数字信号时的一些特性。
#### 收敛区域的判定
收敛区域就是使$$X(z)=\sum_{n = -\infty}^{\infty}x[n]z^{-n}$$级数收敛的变量z的取值域，有以下的判定方法：

### ① 比值判别法
对于级数$$\sum_{n = - \infty}^{\infty} |a_{n}|$$
令$$\rho=\lim_{n \to \infty} \left|\frac{a_{n + 1}}{a_{n}}\right|$$
若$\rho < 1$，则级数收敛；

若$\rho = 1$，则级数不一定收敛；

若$\rho > 1$，级数是发散的。

### ② 根值判别法
对于级数$$\sum_{n = - \infty}^{\infty} |a_{n}|$$
令$$\rho=\lim_{n \to \infty} \sqrt[n]{|a_{n}|}$$
若$\rho < 1$，则级数收敛；

若$\rho = 1$，则级数不一定收敛；

若$\rho > 1$，级数是发散的。
### z变换示例
常见离散信号的z变换及收敛区域

1. 单位脉冲信号
单位脉冲信号$\delta[n]$定义为：当$n = 0$时，$\delta[0]=1$；当$n \neq 0$时，$\delta[n]=0$。

计算其z变换：
$$X(z)=\sum_{n = -\infty}^{\infty}\delta[n]z^{-n}=\delta[0]z^{-0}=1$$
其收敛区域是整个复数平面，因为对于任何$z$值，这个求和都是有限的（只有一项$1$）。

3. 单位阶跃信号
单位阶跃信号$u[n]$定义为：当$n \geq 0$时，$u[n]=1$；当$n < 0$时，$u[n]=0$。

计算其z变换：
$$X(z)=\sum_{n = -\infty}^{\infty}u[n]z^{-n}=\sum_{n = 0}^{\infty}z^{-n}$$
这是一个等比数列求和，当$|z| > 1$时，根据等比数列求和公式可得：
$$X(z)=\frac{1}{1 - z^{-1}}=\frac{z}{z - 1}$$
其收敛区域是$|z| > 1$，因为只有在这个区域内，等比数列的无穷求和才收敛。

5. 单位脉冲的时间延迟信号：
6. 
设单位脉冲信号$\delta[n]$延迟$k$个单位得到$\delta[n - k]$。

已知$\delta[n]$的z变换为$1$，根据时间延迟性质（后面会详细介绍），$\delta[n - k]$的z变换为$z^{-k}$，其收敛区域同样是整个复数平面。
## 给定具体数字信号的z变换及收敛区域
**信号$x = \{1,2,4,3,2,1\},n = 0,1,\cdots,5$：**

计算其z变换：
$$X(z)=\sum_{n = 0}^{5}x[n]z^{-n}=1 + 2z^{-1} + 4z^{-2} + 3z^{-3} + 2z^{-4} + 1z^{-5}$$
对于这种有限长序列，其收敛区域是整个复数平面，因为这个求和是有限项的，不存在收敛性问题。

**信号$x[n]=(0.5)^n u[n]$：**
计算其z变换：
$$X(z)=\sum_{n = -\infty}^{\infty}x[n]z^{-n}=\sum_{n = 0}^{\infty}(0.5)^n z^{-n}=\sum_{n = 0}^{\infty}\left(\frac{z^{-1}}{0.5}\right)^n$$
这又是一个等比数列求和，当$$\left|\frac{z^{-1}}{0.5}\right| < 1$$
即$|z| > 0.5$时，根据等比数列求和公式可得：
$$X(z)=\frac{1}{1 - \frac{z^{-1}}{0.5}}=\frac{1}{1 - \frac{1}{0.5z}}=\frac{0.5z}{0.5z - 1}$$
其收敛区域是$|z| > 0.5$。

## z变换的性质
### 线性运算原则
z变换具有线性性质，即：
$$Z\{\alpha x_1[n]+\beta x_2[n]\}=\alpha X_1(z)+\beta X_2(z)$$
这里$\alpha$和$\beta$是常数，$x_1[n]$和$x_2[n]$是离散序列，$X_1(z)$和$X_2(z)$分别是它们的z变换。

在信号处理中的应用：例如，当我们要对两个经过不同处理（如滤波、放大等）后的信号进行叠加处理时，如果知道这两个信号各自的z变换，就可以利用线性性质直接求出叠加后信号的z变换，从而方便后续对叠加后信号的分析和处理。
### 时间延迟
若$x[n]$的z变换为$X(z)$，则$x[n - k]$的z变换为$z^{-k}X(z)$。

这一性质对z变换的影响在于：它使得我们在分析离散信号经过时间延迟后的变换情况时非常方便。比如在数字通信系统中，当信号在传输过程中可能会出现延迟，通过这个性质我们可以很容易地得到延迟后信号的z变换，进而分析其频域特性等方面的变化。
### 转换函数
 LTI系统的转换函数及作用:
 
LTI（线性时不变）系统的转换函数$H(z)$定义为：
$$H(z)=\frac{\sum_{k = 0}^{M}b_k z^{-k}}{\sum_{k = 0}^{N}a_k z^{-k}}$$
在分析LTI系统特性中的作用：它可以将系统的输入输出关系在z域中进行描述。

通过给定系统的输入信号的z变换$X(z)$，利用转换函数$H(z)$，可以方便地求出系统输出信号的z变换$Y(z)$，即$Y(z)=H(z)X(z)$。

通过系统方块图理解转换函数与系统输入输出的关系：在系统方块图中，输入信号$x[n]$经过LTI系统（其特性由转换函数$H(z)$描述）后得到输出信号$y[n]$。从z变换的角度看，就是输入信号的z变换$X(z)$与转换函数$H(z)$相乘得到输出信号的z变换$Y(z)$。
### 零点与极点
#### 零点和极点的确定及意义
对LTI系统的转换函数$H(z)$进行因式分解，可以得到零点和极点。

零点是使分子$$\sum_{k = 0}^{M}b_k z^{-k}$$为零的$z$值，极点是使分母$$\sum_{k = 0}^{N}a_k z^{-k}$$为零的$z$值。

在系统稳定性判断等方面的意义：零点和极点的位置对于判断系统的稳定性以及分析系统的频率响应等方面有着重要意义。

例如，通过实例展示如何确定系统的零点、极点和收敛区域：
假设我们有一个转换函数$$H(z)=\frac{z - 1}{z^2 - 0.5z + 0.25}$$
首先，求零点：令分子$z - 1 = 0$，解得$z = 1$，所以$z = 1$是该系统的一个零点。

然后，求极点：令分母$z^2 - 0.5z + 0.25 = 0$，通过求解二次方程可得$z = 0.25 \pm 0.25j$，所以这两个值是该系统的极点。

对于收敛区域，需要根据具体的系统和信号情况进行分析，一般来说，要结合极点的位置以及系统的输入输出特性等来确定。
#### 稳定系统与极点的关系
若LTI系统的转换函数$H(z)$的所有极点均落在复数平面的单位圆内，则系统为稳定系统。

极点位置对系统稳定性的影响：当极点在单位圆内时，意味着系统对于有界输入能够产生有界输出，系统是稳定的。如果极点在单位圆外，那么系统可能会对有界输入产生无界输出，导致系统不稳定。
# 反z变换
## 反z变换的计算方法及适用场景
### 长除法：
适用场景：适用于当$X(z)$是一个有理函数，且分母的次数不高于分子的次数时。
计算步骤：将分子除以分母，按照多项式除法的规则进行运算，得到的商的系数就是原离散序列$x[n]$的各项值。
例如，若$$X(z)=\frac{1 + z^{-1}}{1 - z^{-1}}$$
通过长除法：
$$
\begin{align*}
\frac{1 + z^{-1}}{1 - z^{-1}}&=1 + 2z^{-1} + 2z^{-2} + 2z^{-3}+\cdots\\
\end{align*}
$$
所以$$x[n]=\begin{cases}1, & n = 0 \\ 2, & n \geq 1\end{cases}$$
### 部分分式展开法：
适用场景：适用于当$X(z)$是一个有理函数，且分母可以分解成多个一次因式的乘积时。

计算步骤：首先将$X(z)$分解成部分分式的形式，然后根据已知的部分分式形式与常见离散信号z变换的对应关系，求出原离散序列$x[n]$。
例如，若$$X(z)=\frac{1}{(z - 1)(z - 2)}$$
将其分解为部分分式：
$$X(z)=\frac{1}{z - 1}-\frac{1}{z - 2}$$
已知$\frac{1}{z - a}$的反z变换是$a^n u[n]$，所以$$x[n]=(1)^n u[n]-(2)^n u[n]=u[n]-2^n u[n]$$
### 余数法：
适用场景：适用于当$X(z)$是一个有理函数，且分母的次数高于分子的次数时。

计算步骤：通过计算$X(z)z^{n - 1}$在$z = 0$处的余数来确定原离散序列$x[n]$的值。

例如，若$$X(z)=\frac{1}{z^2 - z}$$
对于$n = 0$，计算$$X(z)z^{-1}=\frac{1}{z - 1}$$在$z = 0$处的余数为$1$，所以$x[0]=1$。对于$n > 0$，通过类似的计算方法可以得到相应的$x[n]$值。
## 示例：通过多个具体的信号z变换函数进行反z变换计算
信号$$X(z)=\frac{1 + z^{-1}+2z^{-2}-z^{-3}+3z^{-4}}{1 - 2z^{-1}+z^{-2}}$$
采用部分分式展开法：

首先，对分母进行因式分解：$$1 - 2z^{-1}+z^{-2}=(1 - z^{-1})^2$$
将$X(z)$分解成部分分式：
$X(z)=\frac{A}{1 - z^{-1}}+\frac{B}{(1 - z^{-1})^2}$
通过通分并对比系数可求出$A$和$B$的值，然后根据已知的部分分式形式与常见离散信号z变换的对应关系，求出原离散序列$x[n]$。

信号$X(z)=\frac{1}{1 - 3z^{-1}+2z^{-2}}$
采用部分分式展开法：
首先，对分母进行因式分解：$1 - 3z^{-1}+2z^{-2}=(1 - z^{-1})(1 - 2z^{-1})$
将$X(z)$分解成部分分式：
$$X(z)=\frac{A}{1 - z^{-1}}+\frac{B}{1 - 2z^{-1}}$$
通过通分并对比系数可求出$A$和$B$的值，然后根据已知的部分分式形式与常见离散信号z变换的对应关系，求出原离散序列$x[n]$。

信号$$X(z)=\frac{1}{(z - 0.75)(z + 0.5)}$$
采用部分分式展开法：
将$X(z)$分解成部分分式：
$$X(z)=\frac{A}{z - 0.75}+\frac{B}{z + 0.5}$$
通过通分并对比系数可求出$A$和$B$的值，然后根据已知的部分分式形式与常见离散信号z变换的对应关系，求出原离散序列$x[n]$。